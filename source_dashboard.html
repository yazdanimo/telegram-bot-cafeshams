html = "<html><head><meta charset='utf-8'><title>ğŸ“Š Ú¯Ø²Ø§Ø±Ø´ Ù…Ù†Ø§Ø¨Ø¹</title></head><body>"
html += "<h2>ğŸ“Š ÙˆØ¶Ø¹ÛŒØª Ù…Ù†Ø§Ø¨Ø¹ Ø®Ø¨Ø±</h2><table border='1' cellpadding='5' style='border-collapse:collapse'>"
html += "<tr><th>Ù…Ù†Ø¨Ø¹</th><th>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„</th><th>Ù…ÙˆÙÙ‚</th><th>Ù†Ø§Ù…ÙˆÙÙ‚</th></tr>"

for name, stats in health_report.items():
    total = stats.get("total", 0)
    success = stats.get("success", 0)
    failed = stats.get("failed", 0)
    row_color = "#d4fcdc" if success > failed else "#fde4e1"
    html += f"<tr style='background:{row_color}'><td>{name}</td><td>{total}</td><td>{success}</td><td>{failed}</td></tr>"

html += "</table><br><p>ØªØ§Ø±ÛŒØ® Ú¯Ø²Ø§Ø±Ø´: " + datetime.datetime.now().strftime("%Y-%m-%d %H:%M") + "</p></body></html>"

try:
    with open("source_dashboard.html", "w", encoding="utf-8") as f:
        f.write(html)
except Exception as e:
    print(f"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ source_dashboard.html: {e}")
        html += f"<tr style='background:{color}'><td>{name}</td><td>{total}</td><td>{success}</td><td>{failed}</td></tr>"

    html += "</table><br><p>ØªØ§Ø±ÛŒØ® Ú¯Ø²Ø§Ø±Ø´: " + datetime.datetime.now().strftime("%Y-%m-%d %H:%M") + "</p></body></html>"

    try:
        with open("source_dashboard.html", "w", encoding="utf-8") as f:
            f.write(html)
    except Exception as e:
        print(f"âŒ Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ source_dashboard.html: {e}")
